#summary Description of how to build RSTM

= Introduction =

This page is a stub.  It will eventually have instructions on how to configure and build RSTM.  There are two main targets:

  * Library API: This target is suitable for SPARC, and for x86 platforms that use gcc as a compiler.

  * CXXTM API: This target is suitable for x86 platforms that have the Intel transactional C++ compiler and is in addition to the Library API on such platforms.

== CMake ==

As of our upcoming 7th release RSTM has been upgraded to use the [http://www.cmake.org/ cmake configuration infrastructure] which is [http://www.cmake.org/http://www.cmake.org/cmake/resources/software.html available in binary form] for all of the platforms that we currently support. While we do not knowingly use cmake features that are unsupported in the 2.8.0 release, we recommend downloading the latest stable release (2.8.4 at the time of the 7th release) as we have not extensively tested configuration with other cmake verions.

As of the 7th release we have tested STM configurations on the following platforms.

  * Linux x86(`_`64)
  * Solaris x86(`_`64) and SPARC v9
  * Mac OS X 10.6 x86(`_`64)

We recommend out-of-source builds. As is standard you may create a directory and configure with the execution command `cmake <path-to-RSTM>`. This will configure RSTM with default parameters for your platform, using the Makefile generator. After configuration you can simply `make` and all of the default libraries and executables will be generated.

You have three options for customizing your configuration.

  # You may do an _interactive configuration_ using cmake's `-i` flag. This will prompt you for answers to all of the possible configuration options. Be aware that some options are marked as _advanced_ and thus will only be visible if you say `yes` to cmake's interactive query to show advanced variables. We recommend against setting advanced configuration parameters interactively.
  # You may explicitly set options on the command line using cmake's `-D` command line functionality. See [http://www.cmake.org/ cmake's documentation for more details]. As an example, to build 32-bit libraries and executables on a platform where 64-bit is the default, you could directly set the `rstm_build_32-bit` option on the command line like `cmake <path-to-RSTM> -Drstm_build_32-bit:BOOL=YES`.
  # You may configure using a cmake gui, such as the `ccmake` ncurses gui included in the cmake distribution. We recommend this for browsing and setting advanced configuration parameters, which can be accessed by toggling the view to advanced.

Note that our configurations are adaptive in the sense that enabling certain options may add additional options to your gui. An example is enabling 32-bit builds on Mac OS X, which enables the `mesh` benchmarks and related mesh options.

For developers, user configuration options are declared in `UserConfig.cmake` files in the appropriate directories. For example, configuration options for `libstm` are defined in `libstm/UserConfig.cmake`.

== CMake Options ==

This describes the cmake configuration options as of RSTM's 7th release. Note that there are some dependencies between these options, so some may not be visible on your platform given the rest of your configuration settings.

=== *RSTM* Options ===

RSTM options are defined in `<RSTM>/UserConfig.cmake`. These options control the RSTM configuration itself.

*`rstm_build_32-bit`- RSTM has been designed to support simultaneous 32 and 64-bit builds on platforms where it is applicable. This option enables 32-bit libraries and applications. All 32-bit targets are appended with the string `32`. As an example, the 32-bit version of libstm is titled `libstm32.a`. The default architecture is determined by your C++ compiler's default `sizeof(void*)`.
*`rstm_build_64-bit`- see `rstm_build_32-bit`
*`rstm_enable_itm2stm`- ON enables the itm2stm shim library. This shim is built using the standard C++ compiler on your system, so this option is available even on platforms that have no official ITM ABI compatible compiler.
*`rstm_enable_itm`- ON enables executable builds that link directly with Intel's built-in `libitm.a` library. This option is only available if cmake finds a C++ STM compatible compiler who's ID matches Intel.
*`rstm_enable_newbench`- ON enables the RSTM newbench set of microbenchmarks. The actual benchmarks that are buit depend on your selections for using 32 and/or 64 bits, as well as your selection for `rstm_enable_itm2stm` and `rstm_enable_itm` (in the case where Intel's C++ STM compiler was detected).
*`rstm_enable_stamp`- ON builds the distributed stamp benchmarks. 32 and/or 64 bit versions will be built depending on your configuration.
*`rstm_enable_stamp`- ON builds the mesh benchmark. We currently only support 32 bit mesh builds. Executables will be generated based on your selection of `rstm_enable_itm` and `rstm_enable_itm2stm`.

=== *libstm* Options===

libstm options are defined in `<RSTM>/libstm/UserConfig.cmake`. These options control the libstm build and are embedded in the configured `include/stm/config.h` header so that libstm-dependent libraries and applications know how the library was configured.

=== *mesh* Options ===

Mesh options are defined in `<RSTM>/mesh/UserConfig.cmake` and control which versions of the mesh application to build.

== Stub Notes ==